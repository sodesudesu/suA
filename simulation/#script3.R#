#read library
library(ggplot2)
library(dplyr)
library(tibble)

#clear screen
rm(list = ls())

#(setting) length of one side "l" and number of iteration "t"
l = 1000
t = 10000000

#map vector
map_vec = numeric(l^2)

#random numbers 
random = as.integer(runif(t, 1, l^2))

#the number of "1"
how_many_1 = numeric(t + 1)

#change the numbers of base (=trials)
j = 1 #count

for (i in random) {
  map_vec[i] = ( map_vec[i] + 1 ) %% 2
  j = j + 1
  how_many_1[j] = sum(map_vec) 
}

#count the number of "1"
count_df = tibble(
  iteration = 0:t, 
  count = how_many_1 )

png("1000x1000/1000x1000.png", 800, 400)
#draw figure
ggplot(count_df, aes(x = iteration, y = count)) + 
  scale_y_continuous(limits = c(0, l^2)) +
  geom_path(color = "hotpink") + # 折れ線
  labs(xlab("試行回数"),
       ylab("黒石の数")) +
    theme_bw()
dev.off()
